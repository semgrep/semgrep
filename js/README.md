This is an experimental project to compile Semgrep to Javascript
using js_of_ocaml to compile the OCaml code, and emscripten and WASM to
compile the C code generated by tree-sitter, libyaml, and libpcre.

After running:

```
$ source libs/ocaml-tree-sitter-core/tree-sitter-config.sh
$ make core
$ dune build --profile=release
```

you should get a few MB files in `_build/default/js/engine/Main.bc.js`

Building with `dune build --profile=release` (instead of the default --profile=dev)
has a significant impact on the size of the generated JS file. You can go
from 110MB to 16MB!
See https://discuss.ocaml.org/t/tutorial-full-stack-web-dev-in-ocaml-w-dream-bonsai-and-graphql/9963/8?u=aryx for more information

After you've built all the OCaml, you must build the WebAssembly modules and package
everything together. The easiest way to do this is by running `make` in this folder.

First you need to install `emscripten` and `nodejs`. Then just type `make build`
to build and then `make test` to run some regression tests.

You can then load this file in your browser and test it [here](examples/index.html).

You can also load this file in nodejs and test it with:

```bash
js % node
Welcome to Node.js v16.19.0.
Type ".help" for more information.
> const engine = await require("./engine/dist").EngineFactory();
undefined
> const lua = await require("./languages/lua/dist").ParserFactory();
undefined
> engine.addParser(lua);
undefined
> engine.execute("lua", "rules.json", "test.lua")
'{"matches":[{"rule_id":"test","location":{"path":"test.lua","start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":10,"offset":9}},"extra":{"message":"test","metavars":{"$X":{"start":{"line":1,"col":7,"offset":6},"end":{"line":1,"col":9,"offset":8},"abstract_content":"42"}},"engine_kind":"OSS"}}],"errors":[],"stats":{"okfiles":1,"errorfiles":0},"rules_by_engine":[["test","OSS"]],"engine_requested":"OSS"}'
```
