(library
 (public_name semgrep.parsing)
 (name semgrep_parsing)
 (wrapped false)
 (libraries
   yaml pcre

   commons
   pfff-h_program-lang
   pfff-lang_GENERIC pfff-lang_GENERIC-naming

   pfff-lang_ruby

   ; xxx.menhir, xxx.tree_sitter, xxx.generic
   parser_go.menhir parser_go.tree_sitter parser_go.ast_generic
   parser_ocaml.menhir parser_ocaml.tree_sitter parser_ocaml.ast_generic
   parser_java.menhir parser_java.tree_sitter parser_java.ast_generic
   parser_python.menhir parser_python.tree_sitter parser_python.ast_generic
   parser_c.menhir parser_c.tree_sitter parser_c.ast_generic
   parser_cpp.menhir parser_cpp.tree_sitter parser_cpp.ast_generic
   ; miss tree_sitter (use the one for typescript)
   parser_javascript.menhir parser_javascript.ast_generic
   ; use ast_generic (use the one for javascript)
   parser_typescript.tree_sitter
   parser_json.menhir parser_json.ast_generic

   ojsonnet

   process_limits
   spacegrep

   semgrep_core
   semgrep_optimizing
   semgrep_parsing_tree_sitter
   semgrep_reporting
 )
 (preprocess (pps ppx_profiling ppx_sexp_conv ppx_deriving.show))
)

(rule
 (targets Parsing_stats_j.ml Parsing_stats_j.mli)
 (deps    Parsing_stats.atd)
 (action  (run atdgen -j -j-std %{deps})))

(rule
 (targets Parsing_stats_t.ml Parsing_stats_t.mli)
 (deps    Parsing_stats.atd)
 (action  (run atdgen -t %{deps})))
