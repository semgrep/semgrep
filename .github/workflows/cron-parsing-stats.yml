# AUTOGENERATED FROM cron-parsing-stats.jsonnet DO NOT MODIFY
jobs:
  job:
    container: returntocorp/semgrep:develop
    runs-on: ubuntu-latest-16-core
    steps:
      - uses: actions/checkout@v3
      - name: Install dependencies
        run: apk add bash jq curl
      - run: |
          cd stats/parsing-stats
          ./run-all --upload
      - uses: actions/upload-artifact@v3
        with:
          name: logs.log
          path: stats/parsing-stats/logs
      - uses: actions/upload-artifact@v3
        with:
          name: results.txt
          path: stats/parsing-stats/results.txt
  notify-failure:
    if: failure()
    needs:
      - job
    runs-on: ubuntu-20.04
    steps:
      - run: |
          curl --request POST \
           --url  ${{ secrets.NOTIFICATIONS_URL }} \
           --header 'content-type: application/json' \
           --data '{
             "text": "The cron parsing stats failed. See https://github.com/semgrep/semgrep/actions/workflows/cron-parsing-stats.yml"
           }'
name: cron-parsing-stats
on:
  schedule:
    - cron: 26 7 * * *
  workflow_dispatch: null
