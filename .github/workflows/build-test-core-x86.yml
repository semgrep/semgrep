# AUTOGENERATED FROM build-test-core-x86.jsonnet DO NOT MODIFY
name: build-test-core-x86
"on":
  workflow_dispatch:
  workflow_call:
jobs:
  job:
    steps:
    - name: Make checkout speedy
      run: git config --global fetch.parallel 50
    - uses: actions/checkout@v3
      with:
        submodules: true
    - name: Build semgrep-core
      run: "\n          eval $(opam env)\n          make install-deps-ALPINE-for-semgrep-core\n
        \         make install-deps-for-semgrep-core\n          make core\n\n          mkdir
        -p ocaml-build-artifacts/bin\n          cp bin/semgrep-core ocaml-build-artifacts/bin/\n
        \         tar czf ocaml-build-artifacts.tgz ocaml-build-artifacts\n        "
    - uses: actions/upload-artifact@v3
      with:
        path: ocaml-build-artifacts.tgz
        name: ocaml-build-artifacts-release
    - name: Test semgrep-core
      run: opam exec -- make core-test
    runs-on: ubuntu-latest
    container: returntocorp/ocaml:alpine-2023-10-17
    env:
      HOME: /root
