rules:
  - id: sql-injection
    message: Semgrep found a match
    languages:
      - python
    severity: WARNING
    mode: taint
    pattern-sources:
      - patterns:
          - pattern: |
              def $FN(..., $PARAMS, ...):
                ...
          - focus-metavariable: $PARAMS
      - exact: true
        pattern: framework.db_access.mysql_dict(...)
    pattern-sinks:
      - patterns:
          - pattern-either:
              - pattern: framework.db_access.mysql_dict($SINK)
              - pattern: framework.db_access.mysql_update($SINK)
          - focus-metavariable: $SINK
    pattern-sanitizers:
      - by-side-effect: true
        patterns:
          - pattern: framework.db_access.escape($INPUT)
          - focus-metavariable: $INPUT
