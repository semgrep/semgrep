rules:
- id: spring-sql-injection
  message: >-
    SQLi
  severity: ERROR
  mode: join
  join:
    refs:
    - rule: rules/join_rules/rule_parts/user-input.yaml
      as: spring-user-input
    - rule: rules/join_rules/rule_parts/method-parameter-formatted-sql.yaml
      as: formatted-sql
    - rule: rules/join_rules/rule_parts/java-callgraph.yaml
      as: callgraph
    on:
    - 'spring-user-input.$USERINPUTMETHOD == callgraph.$CALLER'
    - 'callgraph.$CALLER --> callgraph.$CALLEE'
    - 'callgraph.$CALLEE == formatted-sql.$METHODNAME'